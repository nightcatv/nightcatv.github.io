<!DOCTYPE html>


<html lang="zh-TW, en">
  

    <head>
      <meta charset="utf-8" />
        
      <meta name="description" content="一介凡人做的，平凡的隨筆部落格..." />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>Shodan Pentesting |  Night Vestige</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <script src="https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js"></script>
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-Shodan Pentesting"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Shodan Pentesting
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2020/09/08/Shodan%20Pentesting/" class="article-date">
  <time datetime="2020-09-08T11:44:00.000Z" itemprop="datePublished">2020-09-08</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Cyber-Security/">Cyber Security</a> / <a class="article-category-link" href="/categories/Cyber-Security/Attack/">Attack</a> / <a class="article-category-link" href="/categories/Cyber-Security/Attack/Reconnaissance/">Reconnaissance</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">5.7k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">28 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="What-is-Shodan"><a href="#What-is-Shodan" class="headerlink" title="What is Shodan?"></a><strong>What is Shodan?</strong></h2><ul>
<li>Shodan 是個針對網路連接設備的搜尋引擎</li>
<li>可以探查整個網路，其中功能大概有<ul>
<li>找到有連接在網路上的設備，或者是網路服務</li>
<li>監控網路安全</li>
<li>做出全球統計 … 等等</li>
</ul>
</li>
<li>主要的應用在幾個領域：<ul>
<li>Network Security</li>
<li>Market Research</li>
<li>Cyber Risk</li>
<li>Scanning IoT Devices</li>
<li>Tracking Ransomware</li>
</ul>
</li>
<li>Shodan 的網站、資料庫都是大範圍網路埠號掃描的結果<span id="more"></span></li>
</ul>
<h2 id="Shodan-interfaces"><a href="#Shodan-interfaces" class="headerlink" title="Shodan interfaces"></a><strong>Shodan interfaces</strong></h2><ul>
<li>在這邊主要說明連接 Shodan 的幾個方法：<ul>
<li>網路（較為廣泛知道）</li>
<li>官方的 Python Command-line 介面工具與函式庫</li>
<li>其他不同語言的函式庫</li>
<li>官方的 REST API<blockquote>
<p>REST，<strong>Re</strong>source <strong>Re</strong>presentational <strong>S</strong>tate <strong>T</strong>ransfer，可譯為具象狀態傳輸<br>Server / Client 的一種呼叫服務形式，透過既定規則來滿足約束條件和原則的應用程式設計<br>簡單來說，一個單從發出的HTTP要求裡面所包含的資訊，就可直接預期這種要求會收到怎樣類型的資料，也就是「人眼看得懂」</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="CLI-tool"><a href="#CLI-tool" class="headerlink" title="CLI tool"></a><em>CLI tool</em></h3><ul>
<li>官方的 Shodan Command-line 介面是由 Python 所寫的</li>
</ul>
<h4 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h4><ul>
<li>透過 Python 安裝，可使用<code>easy_install</code>或者<code>pip</code><blockquote>
<p>以 Python 3.x 以上的版本來安裝</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> easy_install shodan</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> pip install shodan</span></span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li>如果是使用 Linux / MacOS 需要以 root 身份安裝<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo python3 -m easy_install shodan</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo pip3 install shodan</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>在安裝完後需要設定 API Token  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan init &lt;YOUR_API_KEY&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Command-Overview"><a href="#Command-Overview" class="headerlink" title="Command Overview"></a>Command Overview</h4><ul>
<li>下面會說明幾個比較直觀的指令</li>
</ul>
<h5 id="help"><a href="#help" class="headerlink" title="--help"></a><code>--help</code></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan --<span class="built_in">help</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>會看到下列回應：  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Usage: shodan [OPTIONS] COMMAND [ARGS]...</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -h, --help  Show this message and exit.</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  alert       Manage the network alerts for your account</span><br><span class="line">  convert     Convert the given input data file into a different format.</span><br><span class="line">  count       Returns the number of results for a search</span><br><span class="line">  data        Bulk data access to Shodan</span><br><span class="line">  domain      View all available information for a domain</span><br><span class="line">  download    Download search results and save them in a compressed JSON...</span><br><span class="line">  honeyscore  Check whether the IP is a honeypot or not.</span><br><span class="line">  host        View all available information for an IP address</span><br><span class="line">  info        Shows general information about your account</span><br><span class="line">  init        Initialize the Shodan command-line</span><br><span class="line">  myip        Print your external IP address</span><br><span class="line">  org         Manage your organization&#x27;s access to Shodan</span><br><span class="line">  parse       Extract information out of compressed JSON files.</span><br><span class="line">  radar       Real-Time Map of some results as Shodan finds them.</span><br><span class="line">  scan        Scan an IP/ netblock using Shodan.</span><br><span class="line">  search      Search the Shodan database</span><br><span class="line">  stats       Provide summary information about a search query</span><br><span class="line">  stream      Stream data in real-time.</span><br><span class="line">  version     Print version of this tool.</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="info"><a href="#info" class="headerlink" title="info"></a><code>info</code></h5><ul>
<li>如果設定好 API token，可以確認個人的 credit  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan info</span></span><br><span class="line">Query credis available : 100</span><br><span class="line">Scan credits availabe: 100</span><br></pre></td></tr></table></figure></li>
<li>Query credit 用在搜尋 Shodan 上；而 Scan credit 用在掃描 IP 上<blockquote>
<p>一個搜尋的 request 花費一個 query credit<br>掃描一個 IP 花費一個 scan credit</p>
</blockquote>
</li>
</ul>
<h5 id="version"><a href="#version" class="headerlink" title="version"></a><code>version</code></h5><ul>
<li>確認版本  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan version</span></span><br><span class="line">1.22.0</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="count"><a href="#count" class="headerlink" title="count"></a><code>count</code></h5><ul>
<li>會回傳結果的搜尋數量  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan count openssh</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="download"><a href="#download" class="headerlink" title="download"></a><code>download</code></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan download -h</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Shodan 搜尋後下載的結果進入檔案中會以 JSON banner 的樣式呈現</li>
<li>預設下載 1000 筆結果，可以使用<code>--limit</code>來設定數量</li>
<li>這個指令會儲存結果，並在之後能讓<code>parse</code>指令來處理<blockquote>
<p>如果經常搜尋相同的 query 可以節省 credit<br>[color=#B399FF]</p>
</blockquote>
</li>
<li>Export credit 是用來從網站上下載資料<blockquote>
<p>一個 export credit 下載 10000 筆結果<br>這個 credit 是一次性的，不會每個月自動回補<br>[color=#B399FF]</p>
</blockquote>
<ul>
<li>如果沒有 export credit，可以一個 query credit 來存 100 筆結果</li>
</ul>
</li>
<li>e.g. 下載 1000 筆 openssh query 的資料  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan download openssh-data openssh</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="host"><a href="#host" class="headerlink" title="host"></a><code>host</code></h5><ul>
<li>可以針對某個 host 來查看其資訊，比如所在地、開放的埠號、IP 所屬的組織…  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan host 1.1.1.1</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan host 138.201.81.199</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="myip"><a href="#myip" class="headerlink" title="myip"></a><code>myip</code></h5><ul>
<li>可以回傳個人的實體 IP  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan myip</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="parse"><a href="#parse" class="headerlink" title="parse"></a><code>parse</code></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan parse -h</span></span><br></pre></td></tr></table></figure>
<ul>
<li>可以用來分析下載下來的檔案</li>
<li>可以過濾一些有興趣的欄位，然後將 JSON 格式轉換成 CSV</li>
<li>e.g. 將先前下載的 openssh 做過濾  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan parse --fields location.country_code3, ip_str, hostnames -f port:2222 openssh-data.json.gz</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan parse --fields port, ip_str, location.city, location.postal_code -f location.country_code:FR --separator , openssh-data.json.gz</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="search"><a href="#search" class="headerlink" title="search"></a><code>search</code></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan search -h</span></span><br></pre></td></tr></table></figure>
<ul>
<li>此指令會搜尋 Shodan，並且以 terminal 習慣的格式輸出</li>
<li>預設都會輸出 IP、port、hostname、資料<ul>
<li>可以使用<code>--fields</code>來印有興趣的 banner</li>
</ul>
</li>
<li>一個簡單的 query 不會花費任何 credit，但如果使用 filter 或者檢索第二頁以後的結果就需要花費 credit</li>
<li>e.g. 不會花費 credit  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan search --fields ip_str, port, os smb</span></span><br></pre></td></tr></table></figure></li>
<li>e.g. 會花費一個 credit （因為使用 filter）  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan search --fields ip_str, port, org, info product:mongodb</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="scan"><a href="#scan" class="headerlink" title="scan"></a><code>scan</code></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan scan -h</span></span><br></pre></td></tr></table></figure>
<ul>
<li>掃描 IP / netblock</li>
<li>只要掃描一個 IP 便會花費一個 scan credit</li>
<li>預設掃描的結果會以標準輸出顯示，但可以將其存為檔案，以便之後進行爬取</li>
<li>e.g.  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan scan submit --filename 104.27.154.244_scan.json.gz 104.27.154.244</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>24 小時內不能掃描同一個 host，除非花錢升級<br>[color=red]</p>
</blockquote>
</li>
<li>e.g. 可以看前面掃描的結果，其 ID 跟狀態  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan scan list</span></span><br></pre></td></tr></table></figure></li>
<li>為了節省 credit 不一定要用<code>--filename</code>，可以單純就掃描，接著在根據 ID 來儲存  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan download --<span class="built_in">limit</span> -1 scan-results.json.gz</span></span><br></pre></td></tr></table></figure></li>
<li>掃描可以不同步，可以在任何時候確認掃描的狀態  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan scan status &lt;SCAN_ID&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>可以看掃描時較長的內容  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan scan submit --verbose 13.226.145.4</span></span><br></pre></td></tr></table></figure></li>
<li>Enterprise 版本的可以針對特定埠號、協定、module 做掃描  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan scan internet 8080 wemo-http</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="stats"><a href="#stats" class="headerlink" title="stats"></a><code>stats</code></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan stats -h</span></span><br></pre></td></tr></table></figure>
<ul>
<li>根據搜尋的 query 來給出統合資料</li>
<li>一般預設看十筆，且不是所有面相的資料  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan stats nginx</span></span><br></pre></td></tr></table></figure></li>
<li>但可以調整成自己想要統合的資料數據  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> shodan stats --facets domain, port, asn --<span class="built_in">limit</span> 5 nginx</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Website"><a href="#Website" class="headerlink" title="Website"></a><em>Website</em></h3><h4 id="Main-interface"><a href="#Main-interface" class="headerlink" title="Main interface"></a>Main interface</h4><ul>
<li>Shodan 的主要介面就是一個搜尋引擎</li>
<li>主要跟 CLI Tool 中的搜尋指令一樣，但會有著比較花俏的 WebUI 來呈現結果<ul>
<li>顯示每個 host 的摘要</li>
<li>顯示符合 query 的 host 總數 =&gt; 類似 CLI 中的<code>count</code>，加上一些<code>stat</code><br><img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-22-1536x864.png"></li>
</ul>
</li>
<li>如果選擇其中一個 host，便能夠看到特定的表格、會影響 host 的漏洞、開啟的 port、已開啟 port 的 banner<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-23-1536x864.png"></li>
</ul>
<h5 id="Downloading-data"><a href="#Downloading-data" class="headerlink" title="Downloading data"></a><strong>Downloading data</strong></h5><ul>
<li>在檢索過後，能夠下載結果<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-24-1536x865.png"></li>
<li>接著可以選擇下載的檔案類型：JSON / CSV / XML<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-25.png"><ul>
<li><strong>只有 JSON 格式會包含所有資料且與 Shodan CLI Tool 相容</strong></li>
<li>CSV 格式僅包含 IP, port, banner, organization , hostname</li>
<li>XML 格式被 Shodan 所不贊成，因其耗費比 JSON 還多的空間</li>
</ul>
</li>
<li>可以看到下載的紀錄<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-26.png"></li>
</ul>
<h5 id="Generating-reports"><a href="#Generating-reports" class="headerlink" title="Generating reports"></a><strong>Generating reports</strong></h5><ul>
<li><p>網站可以根據檢索的 query 來產生報表</p>
<ul>
<li>包含圖表 =&gt; 可看到大局上的網路分佈（免費）</li>
</ul>
</li>
<li><p>要產生報表，只要按下在搜尋結果頁面下的<code>Create Report</code><br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-27.png"></p>
<ul>
<li>命名報表名稱<br><img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-28.png"><blockquote>
<p>需要幾分鐘的時間</p>
</blockquote>
</li>
</ul>
</li>
<li><p>可以看到先前所有報表在 <a target="_blank" rel="noopener" href="https://www.shodan.io/report">report</a> 頁面<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-29.png"></p>
<blockquote>
<p>報表不會自動更新</p>
</blockquote>
</li>
</ul>
<h4 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h4><ul>
<li>功能與指令的<code>stats</code>相差不大，唯一的不同只是結果是以互動式的地圖顯示<ul>
<li>其中地點都是基於 host 的物理位置<br><img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-30.png"></li>
</ul>
</li>
<li>本身不會顯示超過一千筆結果，可以拉近或拉遠來看其他結果</li>
</ul>
<h4 id="Images"><a href="#Images" class="headerlink" title="Images"></a>Images</h4><ul>
<li>能夠搜尋被爬到裝置的螢幕截圖<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-31-1536x864.png"></li>
<li>基本上圖片的資料包含五種不同的結果：<ul>
<li>VNC</li>
<li>RDP (Remote Desktop)</li>
<li><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10205976">RTSP (Real Time Streaming Protocol)</a></li>
<li>Webcam</li>
<li>X Windows</li>
</ul>
</li>
<li><code>has_screenshot:true</code>可以用在全域檢索引擎，這樣可以顯示有螢幕截圖的 host</li>
</ul>
<h4 id="Exploits"><a href="#Exploits" class="headerlink" title="Exploits"></a>Exploits</h4><ul>
<li>本身為一個搜尋引擎，主要會檢索多個漏洞資料庫來找漏洞利用的裝置<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-32-1536x864.png"></li>
</ul>
<h4 id="Developer-dashboard"><a href="#Developer-dashboard" class="headerlink" title="Developer dashboard"></a>Developer dashboard</h4><ul>
<li>顯示個人的 credit 使用量，以及 API 的方案<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-33-1536x865.png"></li>
</ul>
<h4 id="Network-monitor"><a href="#Network-monitor" class="headerlink" title="Network monitor"></a>Network monitor</h4><ul>
<li>會持續追蹤已經由該名使用者暴露在網路上的裝置<ul>
<li>設定通知、啟動掃描、取得所有可見資訊</li>
</ul>
</li>
<li>該監控面板能夠追蹤自身的裝置，偵測到可疑之處：<ul>
<li>發出警告</li>
<li>啟動掃描</li>
<li>顯示結果再面板上</li>
</ul>
</li>
<li>在開始使用 =&gt; 加上 IP / IP 範圍 / 域名來監控，選擇要提醒的服務<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-34.png"></li>
<li>可以管理資產，從此處可以啟動掃描或修改觸發規則<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-35-1536x865.png"></li>
<li>可以選擇觸發告警的事件<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-36.png"></li>
<li>Dashboard 會顯示揭露的服務<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-37-1536x864.png"></li>
</ul>
<h4 id="ICS-radar"><a href="#ICS-radar" class="headerlink" title="ICS radar"></a>ICS radar</h4><ul>
<li>是個將 Industrial Control System (ICS) 出現在 Shodan 的設備以 3D 地圖呈現<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-38-1536x864.png"></li>
</ul>
<h4 id="Honeypot-score"><a href="#Honeypot-score" class="headerlink" title="Honeypot score"></a>Honeypot score</h4><ul>
<li>這服務稱為 <a target="_blank" rel="noopener" href="https://honeyscore.shodan.io/">Honeypot or not?</a><ul>
<li>從 IP 來判斷是不是 Honeypot<br><img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-39.png"></li>
</ul>
</li>
<li>在 CLI 上也有一樣的功能  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ shodan honeyscore [IP_Address]</span><br><span class="line">Not a honeypot </span><br><span class="line">Score: 0.3</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Shodan-2000"><a href="#Shodan-2000" class="headerlink" title="Shodan 2000"></a>Shodan 2000</h4><ul>
<li><a target="_blank" rel="noopener" href="https://2000.shodan.io/">Shodan 2000</a>是個類似 Tron 的介面，會隨機展示一個 Host<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-40.png"></li>
</ul>
<h4 id="Community-queries"><a href="#Community-queries" class="headerlink" title="Community queries"></a>Community queries</h4><ul>
<li>可以 <a target="_blank" rel="noopener" href="https://www.shodan.io/explore">explore</a> query =&gt; 輸出或分享<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-41.png"></li>
<li>分享出來的 query 都會有個標題跟描述<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-42.png"></li>
<li>可以點 Share Search<br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-43.png"><br>  <img src="https://community.turgensec.com/wp-content/uploads/2020/02/word-image-44.png"></li>
</ul>
<h3 id="REST-API"><a href="#REST-API" class="headerlink" title="REST API"></a><em>REST API</em></h3><ul>
<li>可以用在基於 Shodan 的網站應用服務，或者建立一個函式庫（沒有最想使用的語言時）</li>
<li>API 的基礎 URL：<code>https://api.shodan.io</code><ul>
<li>所有 API method 流量上限： 1 request / second</li>
</ul>
</li>
<li>API 需要認證 =&gt; 若無則會出現 HTTP 401 錯誤<blockquote>
<p>HTTP 401 Unauthorized</p>
</blockquote>
</li>
<li>查詢 API 資訊的範例：  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -s https://api.shodan.io/api-info?key=&#123;YOUR_API_KEY&#125; | jq</span><br></pre></td></tr></table></figure>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;scan_credits&quot;: 95,</span><br><span class="line">&quot;usage_limits&quot;: &#123;</span><br><span class="line">    &quot;scan_credits&quot;: 100,</span><br><span class="line">    &quot;query_credits&quot;: 100,</span><br><span class="line">    &quot;monitored_ips&quot;: 16</span><br><span class="line">&#125;,</span><br><span class="line">&quot;plan&quot;: &quot;dev&quot;,</span><br><span class="line">&quot;https&quot;: false,</span><br><span class="line">&quot;unlocked&quot;: true,</span><br><span class="line">&quot;query_credits&quot;: 94,</span><br><span class="line">&quot;monitored_ips&quot;: 2,</span><br><span class="line">&quot;unlocked_left&quot;: 94,</span><br><span class="line">&quot;telnet&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>其他查詢 host 資訊  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -s https://api.shodan.io/shodan/host/1.1.1.1?key=&#123;YOUR_API_KEY&#125; | jq</span><br></pre></td></tr></table></figure>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&quot;region_code&quot;: null,</span><br><span class="line">&quot;ip&quot;: 16843009,</span><br><span class="line">&quot;postal_code&quot;: null,</span><br><span class="line">&quot;country_code&quot;: &quot;AU&quot;,</span><br><span class="line">&quot;city&quot;: null,</span><br><span class="line">&quot;dma_code&quot;: null,</span><br><span class="line">&quot;last_update&quot;: &quot;2020-01-25T15:55:54.880090&quot;,</span><br><span class="line">&quot;latitude&quot;: -33.494,</span><br><span class="line">&quot;tags&quot;: [],</span><br><span class="line">&quot;area_code&quot;: null,</span><br><span class="line">&quot;country_name&quot;: &quot;Australia&quot;,</span><br><span class="line">&quot;hostnames&quot;: [</span><br><span class="line">    &quot;one.one.one.one&quot;</span><br><span class="line">],</span><br><span class="line">&quot;org&quot;: &quot;Nountain View Communications&quot;,</span><br><span class="line">&quot;data&quot;: [</span><br><span class="line">    &quot;shodan&quot;: &#123;</span><br><span class="line">        &quot;id&quot;: &quot;f4218ca0-2728-4d7b-97f8-875f4f04149d&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;</span><br><span class="line">            &quot;referrer&quot;: &quot;601b650e-3cc7-4189-babe-921fdf53a9e2&quot;,</span><br><span class="line">            &quot;hostname&quot;: &quot;www.1yhaoduo.com&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ptr&quot;: true,</span><br><span class="line">        &quot;module&quot;: &quot;http&quot;,</span><br><span class="line">        &quot;crawler&quot;: &quot;d264629436af1b777b3b513ca6ed1404d7395d80&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;hash&quot;: -237371161,</span><br><span class="line">    &quot;os&quot;: null,</span><br><span class="line">    &quot;opts&quot;: &#123;&#125;,</span><br><span class="line">    &quot;ip&quot;: 16843009,</span><br><span class="line">    &quot;isp&quot;: &quot;APNIC and Cloudflare DNS Resolver project&quot;,</span><br><span class="line">    &quot;http&quot;: &#123;</span><br><span class="line">        &quot;html_hash&quot;: 1145258596,</span><br><span class="line">        &quot;robots_hash&quot;: null,</span><br><span class="line">        &quot;redirects&quot;: [],</span><br><span class="line">        &quot;securitytxt&quot;: null,</span><br><span class="line">        &quot;title&quot;: &quot;DNS resolution error | www.1yhaoduo.com | Cloudflare&quot;,</span><br><span class="line">        &quot;sitemap_hash&quot;: null,</span><br><span class="line">        &quot;waf&quot;: &quot;CloudFlare&quot;, </span><br><span class="line">        &quot;robots&quot;: null,</span><br><span class="line">        &quot;favicon&quot;: null,</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li>完整的描述可參考 <a target="_blank" rel="noopener" href="https://developer.shodan.io/api">REST API Documentation</a></li>
</ul>
<h3 id="Language-wrappers-libraries"><a href="#Language-wrappers-libraries" class="headerlink" title="Language wrappers (libraries)"></a><em>Language wrappers (libraries)</em></h3><ul>
<li>可以使用包好的函式庫來連接工具與 Shodan API<ul>
<li>官方：Python</li>
<li>社群：Ruby, PHP, Haskell, Rust, Perl, Node.js, Go, PowerShell, Java, C#</li>
</ul>
</li>
</ul>
<h4 id="Python-shodan-python"><a href="#Python-shodan-python" class="headerlink" title="Python - shodan-python"></a>Python - shodan-python</h4><blockquote>
<p>雖然函式庫在 Python 2 跟 3 都可以運作，但這邊以 Python 3 為主</p>
</blockquote>
<ul>
<li>安裝就跟一般 CLI 工具一樣<ul>
<li>在虛擬 Python 環境：  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ easy_install shodan</span><br></pre></td></tr></table></figure></li>
<li>在 BlackArch 上也可以透過下列方式安裝：  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pacman -S python-shodan</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>使用 API 初始化  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shodan</span><br><span class="line"></span><br><span class="line">SHODAN_API_KEY = <span class="string">&quot;API key here&quot;</span></span><br><span class="line"></span><br><span class="line">api = shodan.Shodan(SHODAN_API_KEY)</span><br></pre></td></tr></table></figure></li>
<li>基本查詢：  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># Search Shodan</span></span><br><span class="line">    results = api.search(<span class="string">&quot;apache&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## Show results</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Results found: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(result[<span class="string">&#x27;total&#x27;</span>]))</span><br><span class="line">    <span class="keyword">for</span> result <span class="keyword">in</span> results[<span class="string">&#x27;matches&#x27;</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;IP: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(result[<span class="string">&#x27;ip_str&#x27;</span>]))</span><br><span class="line">    <span class="built_in">print</span>(result[<span class="string">&#x27;data&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">except</span> shodan.APIError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Error: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br></pre></td></tr></table></figure></li>
<li>查詢 Host 開啟的 Port  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># Lookup the host</span></span><br><span class="line">    host = api.host(<span class="string">&#x27;1.1.1.1&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Print general info</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            IP: &#123;&#125;</span></span><br><span class="line"><span class="string">            Organization: &#123;&#125;</span></span><br><span class="line"><span class="string">            Operating System: &#123;&#125;</span></span><br><span class="line"><span class="string">          &quot;&quot;&quot;</span>.<span class="built_in">format</span>(host[<span class="string">&#x27;ip_str&#x27;</span>], host.get(<span class="string">&#x27;org&#x27;</span>, <span class="string">&#x27;n/a&#x27;</span>), host.get(<span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;n/a&#x27;</span>)))</span><br><span class="line">          </span><br><span class="line">    <span class="comment"># Print all banners</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> host[<span class="string">&#x27;data&#x27;</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                Port: &#123;&#125;</span></span><br><span class="line"><span class="string">                Banner: &#123;&#125;</span></span><br><span class="line"><span class="string">              &quot;&quot;&quot;</span>.<span class="built_in">format</span>(item[<span class="string">&#x27;port&#x27;</span>], item[<span class="string">&#x27;data&#x27;</span>]))</span><br><span class="line"><span class="keyword">except</span> shodan.APIError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Error: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br></pre></td></tr></table></figure></li>
<li>顯示統計數據  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The list of properties we want summary information on</span></span><br><span class="line">FACETS = [</span><br><span class="line">    (<span class="string">&quot;org&quot;</span>, <span class="number">3</span>),</span><br><span class="line">    <span class="string">&quot;domain&quot;</span>, </span><br><span class="line">    <span class="string">&quot;port&quot;</span>, </span><br><span class="line">    <span class="string">&quot;asn&quot;</span>, </span><br><span class="line">    (<span class="string">&quot;country&quot;</span>, <span class="number">10</span>),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">FACET_TITLES = &#123;</span><br><span class="line">    <span class="string">&quot;org&quot;</span>: <span class="string">&quot;Top 3 Organizations&quot;</span>,</span><br><span class="line">    <span class="string">&quot;domain&quot;</span>: <span class="string">&quot;Top 5 Domains&quot;</span>,</span><br><span class="line">    <span class="string">&quot;port&quot;</span>: <span class="string">&quot;Top 5 Ports&quot;</span>,</span><br><span class="line">    <span class="string">&quot;asn&quot;</span>: <span class="string">&quot;Top 5 Autonomous Systems&quot;</span>,</span><br><span class="line">    <span class="string">&quot;country&quot;</span>: <span class="string">&quot;Top 10 Contries&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># Query</span></span><br><span class="line">    query = <span class="string">&#x27;apache 2.4&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Count results</span></span><br><span class="line">    result = api.count(query, facets = FACETS)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Shodan Summary Information&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Query: %s&quot;</span> % query)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Total Results: %s\n&quot;</span> % result[<span class="string">&#x27;total&#x27;</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Print the summary info from the facets</span></span><br><span class="line">    <span class="keyword">for</span> facet <span class="keyword">in</span> result[<span class="string">&#x27;facets&#x27;</span>]:</span><br><span class="line">        <span class="built_in">print</span>(FACET_TITLES[facet])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> term <span class="keyword">in</span> result[<span class="string">&#x27;facets&#x27;</span>][facet]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;%s: %s&quot;</span> % (term[<span class="string">&#x27;value&#x27;</span>], term[<span class="string">&#x27;count&#x27;</span>]))</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># Print an empty line between summary info</span></span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">except</span> shodan.APIError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Error: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br></pre></td></tr></table></figure></li>
<li>這些範例都是參考自 <a target="_blank" rel="noopener" href="https://shodan.readthedocs.io/en/latest/">Official Documentation</a></li>
</ul>
<h4 id="Ruby-shodanz"><a href="#Ruby-shodanz" class="headerlink" title="Ruby - shodanz"></a>Ruby - shodanz</h4><ul>
<li>在虛擬 Ruby 環境安裝：  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gem install shodanz</span><br></pre></td></tr></table></figure></li>
<li>使用 API key 初始化  <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&#x27;shodanz&#x27;</span></span><br><span class="line"></span><br><span class="line">api = Shodanz.client.new(<span class="symbol">key:</span> <span class="string">&#x27;YOUR_API_KEY&#x27;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>如果是專案，可以透過環境變數 <code>SHODAN_API_KEY</code> 來讀取 API key</li>
</ul>
</li>
<li>基本查詢  <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Search Shodan</span></span><br><span class="line">results = api.host_search(<span class="string">&#x27;apache&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show results</span></span><br><span class="line">puts <span class="string">&quot;Results found: <span class="subst">#&#123;results[<span class="string">&#x27;total&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line">results[<span class="string">&#x27;matches&#x27;</span>].each <span class="keyword">do</span> <span class="params">|result|</span></span><br><span class="line">    puts <span class="string">&quot;IP: <span class="subst">#&#123;result[<span class="string">&#x27;ip_str&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line">    puts result[<span class="string">&#x27;data&#x27;</span>] + <span class="string">&quot;\n&quot;</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li>
<li>查詢 Host 開啟的 Port  <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Lookup the host</span></span><br><span class="line">host = api.host(<span class="string">&#x27;1.1.1.1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print general info</span></span><br><span class="line">puts <span class="string">&quot;</span></span><br><span class="line"><span class="string">    IP: <span class="subst">#&#123;host[<span class="string">&#x27;ip_str&#x27;</span>]&#125;</span></span></span><br><span class="line"><span class="string">    Organization: <span class="subst">#&#123;host[<span class="string">&#x27;org&#x27;</span>] <span class="params">||</span> <span class="string">&#x27;n/a&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">    Operating System: <span class="subst">#&#123;host[<span class="string">&#x27;os&#x27;</span>] <span class="params">||</span> <span class="string">&#x27;n/a&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print all banners</span></span><br><span class="line">host[<span class="string">&#x27;data&#x27;</span>].each <span class="keyword">do</span> <span class="params">|item|</span></span><br><span class="line">    puts <span class="string">&quot;</span></span><br><span class="line"><span class="string">        Port: <span class="subst">#&#123;item[<span class="string">&#x27;port&#x27;</span>] <span class="params">||</span> <span class="string">&#x27;n/a&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">        Banner: <span class="subst">#&#123;item[<span class="string">&#x27;data&#x27;</span>] <span class="params">||</span> <span class="string">&#x27;n/a&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    &quot;</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li>
<li>顯示統計數據  <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The list of properties we want summary information on</span></span><br><span class="line">FACETS = &#123;</span><br><span class="line"><span class="string">&#x27;org&#x27;</span>: <span class="number">3</span>,</span><br><span class="line"><span class="string">&#x27;domain&#x27;</span>: <span class="number">5</span>,</span><br><span class="line"><span class="string">&#x27;port&#x27;</span>: <span class="number">5</span>, </span><br><span class="line"><span class="string">&#x27;asn&#x27;</span>: <span class="number">5</span>,</span><br><span class="line"><span class="string">&#x27;country&#x27;</span>: <span class="number">10</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">FACET_TITLES = &#123;</span><br><span class="line"><span class="string">&#x27;org&#x27;</span>: <span class="string">&#x27;Top 3 Organizations&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;Top 5 Domains&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;port&#x27;</span>: <span class="string">&#x27;Top 5 Ports&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;asn&#x27;</span>: <span class="string">&#x27;Top 5 Autonomous Systems&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;country&#x27;</span>: <span class="string">&#x27;Top 10 Countries&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Query</span></span><br><span class="line">query = <span class="string">&#x27;apache 2.4&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Count results</span></span><br><span class="line">result = api.host_count(query, <span class="symbol">facets:</span> FACETS)</span><br><span class="line">puts <span class="string">&quot;Shodan Summary Information&quot;</span></span><br><span class="line">puts <span class="string">&quot;Query: <span class="subst">#&#123;query&#125;</span>&quot;</span></span><br><span class="line">puts <span class="string">&quot;Total Results: <span class="subst">#&#123;result[<span class="string">&#x27;total&#x27;</span>]&#125;</span>\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print the summary info from the facets</span></span><br><span class="line">result[<span class="string">&#x27;facets&#x27;</span>].each <span class="keyword">do</span> <span class="params">|facet, _v|</span></span><br><span class="line">    puts FACETS_TITLES[facet]</span><br><span class="line"></span><br><span class="line">    result[<span class="string">&#x27;facets&#x27;</span>][facet].each <span class="keyword">do</span> <span class="params">|term|</span></span><br><span class="line">        puts <span class="string">&quot;<span class="subst">#&#123;term[<span class="string">&#x27;value&#x27;</span>]&#125;</span>: <span class="subst">#&#123;term[<span class="string">&#x27;count&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Print an empty line between summary info</span></span><br><span class="line">    puts <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li>
<li>Async 支援串流 API  <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&#x27;async&#x27;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;shodanz&#x27;</span></span><br><span class="line"></span><br><span class="line">api = Shodanz.client.new(<span class="symbol">key:</span> <span class="string">&#x27;YOUR_API_KEY&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Asynchronously stream banner info from shodan and check any</span></span><br><span class="line"><span class="comment"># IP addresses against the experimental honeypot scoring service</span></span><br><span class="line">api.streaming_api.banners <span class="keyword">do</span> <span class="params">|banner|</span></span><br><span class="line">    <span class="keyword">if</span> ip = banner[<span class="string">&#x27;ip_str&#x27;</span>]</span><br><span class="line">        Async <span class="keyword">do</span></span><br><span class="line">            score = api.rest_api.honeypot_score(ip).wait</span><br><span class="line">            puts <span class="string">&quot;<span class="subst">#&#123;ip&#125;</span> has a <span class="subst">#&#123;score * <span class="number">100</span>&#125;</span>% chance of being a honeypot&quot;</span></span><br><span class="line">            <span class="keyword">rescue</span> Shodanz::Errors::RateLimited</span><br><span class="line">            sleep rand</span><br><span class="line">            <span class="keyword">retry</span></span><br><span class="line">            <span class="keyword">rescue</span> <span class="comment"># any other errors</span></span><br><span class="line">            <span class="keyword">next</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意！</strong> 要使用串流 API 的話，免費版跟開發者版沒有<br>此範例來自 shodanz 文件</p>
</blockquote>
</li>
<li>有用的 method  <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Returns all the protocols that can be used when launching an Internet scan</span></span><br><span class="line">api.protocols</span><br><span class="line"></span><br><span class="line"><span class="comment"># Returns a list of port numbers that the Shodan crawlers are looking for</span></span><br><span class="line">api.ports</span><br><span class="line"></span><br><span class="line"><span class="comment"># Returns information about the Shodan account linked to this API key</span></span><br><span class="line">api.profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># Look up the IP address for the provided list of hostnames</span></span><br><span class="line">api.resolve(<span class="string">&#x27;archlinux.org&#x27;</span>, <span class="string">&#x27;blackarch.org&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Look up the hostnames that have been defined for the given list of IP addresses</span></span><br><span class="line">api.reverse_lookup(<span class="string">&#x27;138.201.81.199&#x27;</span>, <span class="string">&#x27;176.31.253.211&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get your current IP address as seen from the Internet</span></span><br><span class="line">api.my_ip</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculates a honeypot probability score ranging from 0 (not a honeypot) to 1.0 (is a honeypot)</span></span><br><span class="line">api.honeypot_score(<span class="string">&#x27;1.1.1.1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># API Plan Information</span></span><br><span class="line">api.info</span><br></pre></td></tr></table></figure></li>
<li>Exploits API  <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">puts client.exploit_count(<span class="symbol">port:</span> <span class="number">22</span>, <span class="symbol">page:</span> <span class="number">1</span>)</span><br><span class="line">puts client.exploit_search(<span class="string">&#x27;rce couchdb&#x27;</span>, <span class="symbol">type:</span> <span class="string">&#x27;remote&#x27;</span>, <span class="symbol">platform:</span> <span class="string">&#x27;linux&#x27;</span>, <span class="symbol">author:</span> <span class="string">&#x27;Metasploit&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li>可以找到更多的<a target="_blank" rel="noopener" href="https://github.com/picatz/shodanz/tree/master/examples">範例</a>，或讀 <a target="_blank" rel="noopener" href="https://www.rubydoc.info/gems/shodanz">shodanz API Documentation</a></li>
</ul>
<h4 id="Node-js-shodan-client"><a href="#Node-js-shodan-client" class="headerlink" title="Node.js - shodan-client"></a>Node.js - shodan-client</h4><ul>
<li>在虛擬 nodejs 環境安裝：  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i shodan-client</span><br></pre></td></tr></table></figure></li>
<li>使用 API key 初始化  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;util&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> api = <span class="built_in">require</span>(<span class="string">&#x27;shodan-client&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&quot;API key here&quot;</span>;</span><br></pre></td></tr></table></figure></li>
<li>基本查詢  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> searchOpts = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> searchQuery = <span class="string">&quot;apache&quot;</span>;</span><br><span class="line"></span><br><span class="line">api</span><br><span class="line">    .search(searchQuery, key, searchOpts)    <span class="comment">// Search Shodan</span></span><br><span class="line">    .then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;Results found: &quot;</span> + results[<span class="string">&#x27;total&#x27;</span>] + <span class="string">&quot;\n&quot;</span>);    <span class="comment">// Show results</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> result <span class="keyword">of</span> results[<span class="string">&#x27;matches&#x27;</span>]) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`IP: <span class="subst">$&#123;result[<span class="string">&#x27;ip_str&#x27;</span>]&#125;</span>`</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(result[<span class="string">&#x27;data&#x27;</span>] + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;Error: &quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></li>
<li>查詢 Host 開啟的 Port  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> searchOpts = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ip = <span class="string">&quot;1.1.1.1&quot;</span>;</span><br><span class="line"></span><br><span class="line">api</span><br><span class="line">    .host(ip, key, searchOpts)    <span class="comment">// Lookup the host</span></span><br><span class="line">    .then(<span class="function"><span class="params">host</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// Print general info</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`</span></span><br><span class="line"><span class="string">            IP: <span class="subst">$&#123;host[<span class="string">&#x27;ip_str&#x27;</span>]&#125;</span></span></span><br><span class="line"><span class="string">            Organization: <span class="subst">$&#123;host[<span class="string">&#x27;org&#x27;</span>] || <span class="string">&#x27;n/a&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">            Operating System: <span class="subst">$&#123;host[<span class="string">&#x27;os&#x27;</span>] || <span class="string">&#x27;n/a&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">        `</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Print all banners</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> host[<span class="string">&#x27;data&#x27;</span>]) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`</span></span><br><span class="line"><span class="string">                Port: <span class="subst">$&#123;item[<span class="string">&#x27;port&#x27;</span>] || <span class="string">&#x27;n/a&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">                Banner: <span class="subst">$&#123;item[<span class="string">&#x27;data&#x27;</span>] || <span class="string">&#x27;n/a&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">            `</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;Error: &quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></li>
<li>顯示統計數據  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> FACETS = &#123;</span><br><span class="line">    <span class="string">&quot;org&quot;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&quot;domain&quot;</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">&quot;port&quot;</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">&quot;asn&quot;</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">&quot;country&quot;</span>: <span class="number">10</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> FACET_TITLES = &#123;</span><br><span class="line">    <span class="string">&quot;org&quot;</span>: <span class="string">&quot;Top 3 Organizations&quot;</span>,</span><br><span class="line">    <span class="string">&quot;domain&quot;</span>: <span class="string">&quot;Top 5 Domains&quot;</span>,</span><br><span class="line">    <span class="string">&quot;port&quot;</span>: <span class="string">&quot;Top 5 Ports&quot;</span>,</span><br><span class="line">    <span class="string">&quot;asn&quot;</span>: <span class="string">&quot;Top 5 Autonomous Systems&quot;</span>,</span><br><span class="line">    <span class="string">&quot;country&quot;</span>: <span class="string">&quot;Top 10 Countries&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://github.com/jesusprubio/shodan-client/issues/34</span></span><br><span class="line"><span class="comment">// const opts = &#123;facets: FACETS&#125;;</span></span><br><span class="line"><span class="keyword">const</span> opts = &#123; <span class="attr">facets</span>:</span><br><span class="line">    <span class="built_in">JSON</span>.stringify(FACETS).replace(<span class="regexp">/[&quot;&#123;&#125;]/g</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Query</span></span><br><span class="line"><span class="keyword">const</span> query = <span class="string">&#x27;apache 2.4&#x27;</span>;</span><br><span class="line"></span><br><span class="line">api</span><br><span class="line">    .count(query, key, opts)    <span class="comment">// Count results</span></span><br><span class="line">    .then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;Shodan Summary Information&quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Query: <span class="subst">$&#123;query&#125;</span>`</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`Total Results: <span class="subst">$&#123;result[<span class="string">&#x27;total&#x27;</span>]&#125;</span>\n`</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Print the summary info from the facets</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> facet <span class="keyword">in</span> result[<span class="string">&#x27;facets&#x27;</span>])&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(FACET_TITLES[facet]);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> term <span class="keyword">of</span> result[<span class="string">&#x27;facets&#x27;</span>][facet]) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;term[<span class="string">&#x27;value&#x27;</span>]&#125;</span>: <span class="subst">$&#123;term[<span class="string">&#x27;count&#x27;</span>]&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Print an empty line between summary info</span></span><br><span class="line">            <span class="built_in">console</span>.log();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;Error: &quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a><em>Plugins</em></h3><h4 id="Firefox"><a href="#Firefox" class="headerlink" title="Firefox"></a><a target="_blank" rel="noopener" href="https://addons.mozilla.org/en-US/firefox/addon/shodan_io/">Firefox</a></h4><ul>
<li>會從 Shodan.io 蒐集當前瀏覽頁面的資訊</li>
<li>顯示一般的資訊：組織、開啟的 Port</li>
</ul>
<h4 id="Chromium"><a href="#Chromium" class="headerlink" title="Chromium"></a><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/shodan/jjalcfnidlmpjhdfepjhjbhnhkbgleap">Chromium</a></h4><ul>
<li>會顯示網站的位置（國家、程式），誰擁有 IP、有什麼服務或 Port 是開啟的</li>
</ul>
<hr>
<h2 id="Shodan-Search-Query-Syntax"><a href="#Shodan-Search-Query-Syntax" class="headerlink" title="Shodan Search Query Syntax"></a><strong>Shodan Search Query Syntax</strong></h2><h3 id="Banner-and-properties"><a href="#Banner-and-properties" class="headerlink" title="Banner and properties"></a><em>Banner and properties</em></h3><ul>
<li>在 Shodan 當中，一個「banner」代表者一個包含某服務資訊的物件</li>
<li>e.g. <a target="_blank" rel="noopener" href="https://help.shodan.io/the-basics/search-query-fundamentals">官方文件</a>中有一個簡化的 banner 範例  <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;data&quot;</span>: <span class="string">&quot;Moxa Nport Device</span></span><br><span class="line"><span class="string">         Status: Authentication disabled</span></span><br><span class="line"><span class="string">         Name: NP5232I_4728</span></span><br><span class="line"><span class="string">         MAC: 00:90:e8:47:10:2d&quot;</span>,</span><br><span class="line"><span class="attr">&quot;ip_str&quot;</span>: <span class="string">&quot;46.252.132.235&quot;</span>,</span><br><span class="line"><span class="attr">&quot;port&quot;</span>: <span class="number">4800</span>,</span><br><span class="line"><span class="attr">&quot;org&quot;</span>: <span class="string">&quot;Starhub Mobile&quot;</span>,</span><br><span class="line"><span class="attr">&quot;location&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;country_code&quot;</span>: <span class="string">&quot;SG&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>每個 dictionary 的 key 都可稱為一個 property (data、ip_str、port等)</li>
<li>每個 property 都存有不同型別的某服務的資訊</li>
</ul>
</li>
<li>預設上 Shodan 僅能讀取資料的屬性</li>
</ul>
<h3 id="Search-filters"><a href="#Search-filters" class="headerlink" title="Search filters"></a><em>Search filters</em></h3><ul>
<li>要找到前一個範例 banner<ul>
<li>可以檢索 Moxa Nport Device</li>
<li>但前提是要限縮莊志維 Starhub Mobile，否則不一定會回傳預期的結果<blockquote>
<p>原因就是 Shodan 預設僅搜尋資料 property<br>[color=#B399FF]</p>
</blockquote>
</li>
</ul>
</li>
<li>要用其他 property 檢索資料，必須要使用 filter</li>
<li>search filter 是在 Shodan 中輸入特殊關鍵字來找預期的 property<ul>
<li>filter 主要的格式都是 <code>key:value</code></li>
<li>e.g.<ul>
<li>找 Starhub 行動網路的裝置 =&gt; <code>org:&quot;Starhub Mobile&quot;</code></li>
<li>找在新加坡的裝置 =&gt; <code>country:SG</code></li>
<li>可以結合 =&gt; <code>org:&quot;Starhub Mobile&quot; country:SG</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Properties-filters-specification"><a href="#Properties-filters-specification" class="headerlink" title="Properties / filters specification"></a><em>Properties / filters specification</em></h3><ul>
<li>有完整的 banner 屬性清單在<a target="_blank" rel="noopener" href="https://developer.shodan.io/api/banner-specification">官方文件</a></li>
</ul>
<h4 id="General-properties"><a href="#General-properties" class="headerlink" title="General properties"></a>General properties</h4><table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>asn</td>
<td>String</td>
<td>獨立系統編號 (e.g. “AS4837”)</td>
</tr>
<tr>
<td>data</td>
<td>String</td>
<td>包含服務的 banner 資訊</td>
</tr>
<tr>
<td>ip</td>
<td>Integer</td>
<td>host 的 IP (整數型態)</td>
</tr>
<tr>
<td>ip_str</td>
<td>String</td>
<td>host 的 IP (字串型態)</td>
</tr>
<tr>
<td>ipv6</td>
<td>String</td>
<td>host 的 IPv6 (字串型態)，如果有此項則不會出現”ip”、”ip_str”兩項</td>
</tr>
<tr>
<td>port</td>
<td>Integer</td>
<td>運行服務的埠號</td>
</tr>
<tr>
<td>timestamp</td>
<td>String</td>
<td>banner 從在 UTC 時區的裝置取回的時籤</td>
</tr>
<tr>
<td>hostnames</td>
<td>String[]</td>
<td>所有該裝置 IP 位置的主機名稱</td>
</tr>
<tr>
<td>domains</td>
<td>String[]</td>
<td>所有該裝置最高層級域名，在過濾 TLD 時很好用，能處理域名中有多個點的狀況 (e.g. “co.uk”)</td>
</tr>
<tr>
<td>location</td>
<td>Object</td>
<td>包含所有裝置所在位置資訊的物件</td>
</tr>
<tr>
<td>location.area_code</td>
<td>Integer</td>
<td>區域號碼 (僅在美國有效)</td>
</tr>
<tr>
<td>location.city</td>
<td>String</td>
<td>裝置位置的城市名</td>
</tr>
<tr>
<td>location.country_code</td>
<td>String</td>
<td>裝置位置的城市名 (兩個字母)</td>
</tr>
<tr>
<td>location.country_code3</td>
<td>String</td>
<td>裝置位置的城市名 (三個字母)</td>
</tr>
<tr>
<td>location.country_name</td>
<td>String</td>
<td>裝置位置的國家名</td>
</tr>
<tr>
<td>location.dma_code</td>
<td>Integer</td>
<td>裝置所在指定的市場區域號碼（僅在美國有效）</td>
</tr>
<tr>
<td>location.latitude</td>
<td>Double</td>
<td>裝置所在緯度</td>
</tr>
<tr>
<td>location.longitude</td>
<td>Double</td>
<td>裝置所在經度</td>
</tr>
<tr>
<td>location.postal_code</td>
<td>String</td>
<td>裝置位置的郵遞區號</td>
</tr>
<tr>
<td>location.region_code</td>
<td>String</td>
<td>裝置位置區域名稱</td>
</tr>
<tr>
<td>opts</td>
<td>Object</td>
<td>包含服務的實驗性資料和支援性資料，可包含 SSL 憑證、robots.txt、其他未正規化的資訊到 Banner</td>
</tr>
<tr>
<td>org</td>
<td>String</td>
<td>給予裝置 IP 空間的組織名稱</td>
</tr>
<tr>
<td>isp</td>
<td>String</td>
<td>提供裝置 IP 空間組織的 ISP，可認為是組織的母機構，有 IP 的所有權</td>
</tr>
<tr>
<td>os</td>
<td>String</td>
<td>裝置的作業系統</td>
</tr>
<tr>
<td>transport</td>
<td>String</td>
<td>為 udp 或 tcp，標明 IP 傳輸協定</td>
</tr>
</tbody></table>
<h4 id="Optional-properties"><a href="#Optional-properties" class="headerlink" title="Optional properties"></a>Optional properties</h4><table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>uptime</td>
<td>Integer</td>
<td>裝置在線時間（分鐘）</td>
</tr>
<tr>
<td>link</td>
<td>String</td>
<td>網路連線類型，可能的值有<br/>1. Ethernet / Modem<br/>2. Generic Tunnel / VPN<br/>3. DSL<br/>4. IPIP / SIT<br/>5. IPSec / GRE<br/>6. VLAN<br/>7. Jumbo Ethernet<br/>8. Google<br/>9. GIF<br/>10. PPTP<br/>11. Loopback<br/>12. AX.25 Radio Modem</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>從 HTML 輸出的網站標題</td>
</tr>
<tr>
<td>html</td>
<td>String</td>
<td>網站的 HTML 原始碼</td>
</tr>
<tr>
<td>product</td>
<td>String</td>
<td>產生 banner 的產品名稱</td>
</tr>
<tr>
<td>version</td>
<td>String</td>
<td>產生 banner 的產品版本</td>
</tr>
<tr>
<td>devicetype</td>
<td>String</td>
<td>裝置類型 (e.g. webcam, router, etc.)</td>
</tr>
<tr>
<td>info</td>
<td>String</td>
<td>產品的其他資訊</td>
</tr>
<tr>
<td>cpe</td>
<td>String</td>
<td>相關產品的 CPE 或已知漏洞，更多資訊可查詢 CPE 官網或字典</td>
</tr>
</tbody></table>
<h4 id="SSL-properties"><a href="#SSL-properties" class="headerlink" title="SSL properties"></a>SSL properties</h4><table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>ssl.cert</td>
<td>Object</td>
<td>憑證屬性，包含頒發時間、SSL 副檔、頒發者等等</td>
</tr>
<tr>
<td>ssl.cipher</td>
<td>Object</td>
<td>SSL 連線偏好加密演算法</td>
</tr>
<tr>
<td>ssl.chain</td>
<td>Array</td>
<td>憑證的陣列，每個字串都是一個 PEM 加密 SSL 憑證，其中包含使用者 SSL 憑證到 root 憑證</td>
</tr>
<tr>
<td>ssl.dhparams</td>
<td>Object</td>
<td>Diffie-Hellman 參數：<br/>1. prime<br/>2. public_key<br/>3. bits<br/>4. generator<br/>5. fingerprint (optional)<br/>假設知道一個程式產生這些參數</td>
</tr>
<tr>
<td>ssl.versions</td>
<td>Array</td>
<td>Server 支援的 SSL 版本清單，如果版本不支援會在前面加上 “-“<br/>e.g. <code>[&quot;TLSv1&quot;, &quot;-SSLv2&quot;]</code> 表示支援 TLSv1，但不支援 SSLv2</td>
</tr>
</tbody></table>
<h3 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a><em>Miscellaneous</em></h3><ul>
<li>網站的 beta 版本提供了兩種有用的頁面：<ul>
<li><a target="_blank" rel="noopener" href="https://beta.shodan.io/search/filters">Filters</a> - filter / property 的 cheat sheet 清單</li>
<li><a target="_blank" rel="noopener" href="https://beta.shodan.io/search/examples">Examples</a> - 檢索的 query 範例清單</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Shodan-dorks-amp-use-cases"><a href="#Shodan-dorks-amp-use-cases" class="headerlink" title="Shodan dorks &amp; use cases"></a><strong>Shodan dorks &amp; use cases</strong></h2><ul>
<li>從一些簡單的 <a target="_blank" rel="noopener" href="https://snippets.shodan.io/tag/shodan">Shodan Snippets</a> 開始<ul>
<li>Number of devices vulnerable to Heartbleed  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan count vuln:cve-2014-0160</span><br></pre></td></tr></table></figure></li>
<li>Get a list of subdomains for a domain  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan domain cnn.com</span><br></pre></td></tr></table></figure></li>
<li>Create a private firehose for your network and subscribe to it  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan alert create mynetwork 198.20.58.0/24 &amp;&amp; shodan stream --alerts=all</span><br></pre></td></tr></table></figure></li>
<li>Find the top 10 most common vulnerabilities in Switzerland  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan stats --facets vuln country:CH</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>一些公開的 <a target="_blank" rel="noopener" href="https://www.shodan.io/explore">Shared Queries</a><ul>
<li>D-Link Internet Camera DCS-5300 series, without authentication  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;d-Link Internet Camera, 200 OK&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>FTP server with anonymous authentication enabled  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;230 login successful port:21&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>Databases  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MySQL</span></span><br><span class="line">$ shodan search <span class="string">&#x27;product:MySQL&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MongoDB</span></span><br><span class="line">$ shodan search <span class="string">&#x27;product:MongoDB&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># elastic</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:9200 json&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Memcached</span></span><br><span class="line">$ shodan search <span class="string">&#x27;product:Memcached&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CouchDB</span></span><br><span class="line">$ shodan search <span class="string">&#x27;product:CouchDB&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PostgreSQL</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:5432 PostgreSQL&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Riak</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:8087 Riak&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis</span></span><br><span class="line">$ shodan search <span class="string">&#x27;product:Redis&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Cassandra</span></span><br><span class="line">$ shodan search <span class="string">&#x27;product:Cassandra&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>Games  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Minecraft</span></span><br><span class="line">$ shodan search <span class="string">&#x27;Minecraft Server port:25565&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Counter-Strike: Global Offensive</span></span><br><span class="line">$ shodan search <span class="string">&#x27;product: &quot;Counter-Strike Global Offensive&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Starbound</span></span><br><span class="line">$ shodan search <span class="string">&#x27;product:Starbound&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ARK: Survival Evolved</span></span><br><span class="line">$ shodan search <span class="string">&#x27;product:&quot;ARK Survival Evolved&quot;&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>Industrial Control Systems  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># XZERES Wind Turbine</span></span><br><span class="line">$ shodan search <span class="string">&#x27;title:&quot;xzeres wind&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PIPS Automated License Plate Reader</span></span><br><span class="line">$ shodan search <span class="string">&#x27;html:&quot;PIPS Technology ALPR Processors&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Modbus</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:502&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Niagara Fox</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:1911,4911 product:Niagara&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># GE-SRTP</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:18245,18246 product:&quot;general electric&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MELSEC-Q</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:5006,5007 product:mitsubishi&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CODESYS</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:2455 operating system&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># S7</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:102&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># BACnet</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:47808&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HART-IP</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:5094 hart-ip&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Omron FINS</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:9600 response code&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># IEC 60870-5-104</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:2404 asdu address&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DNP3</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:20000 source address&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># EtherNet/IP</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:44818&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PCWorx</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:1962 PLC&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Crimson v3.0</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:789 product:&quot;Red Lion Controls&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ProConOS</span></span><br><span class="line">$ shodan search <span class="string">&#x27;port:20547 PLC&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>由 <a target="_blank" rel="noopener" href="https://twitter.com/dalmoz_">dalmoz</a> 找到的 <a target="_blank" rel="noopener" href="https://twitter.com/i/events/924862201667702784?lang=fr">Shodan Dork</a><ul>
<li><a target="_blank" rel="noopener" href="https://asciinema.org/~Shodan">ASCII video examples</a></li>
<li>Hacked Ubiquiti Network Device  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;hacked-router-help-sos&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>Surveillance cameras, user: admin, no password  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;hacked-router-help-sos&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>Home routers’ storage/attached USB storage  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;IPC$ all storage devices&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>PBX phone gateways without authentication  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;port:23 console gateway -password&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>Lantronix ethernet adapter’s admin interface without password  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;Press Enter for Setup Mode port:9999&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>Polycom video-conference system no-auth shell  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;&quot;polycom command shell&quot;&#x27;</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>VNC servers without authentication  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;&quot;authentication disabled&quot; port:5900,5901&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>NPort serial-to-eth / MoCA devices without password  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;nport -keyin port:23&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>一些 PenTestIT 的 query<ul>
<li>Default Jenkins installations  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;http.favicon.hash:81586312&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>SonarQube installations  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;http.favicon.hash:1485257654&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>IBM WebSphere version disclosure  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ shodan search <span class="string">&#x27;WASRemoteRuntimeVersion&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>一些不錯的檢索 query: <a target="_blank" rel="noopener" href="https://github.com/jakejarvis/awesome-shodan-queries">Awesome Shodan Search Queries</a></li>
</ul>
<hr>
<blockquote>
<p>References:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://community.turgensec.com/shodan-pentesting-guide/">Shodan Pentesting Guide</a></li>
<li><a target="_blank" rel="noopener" href="https://help.shodan.io/the-basics/search-query-fundamentals">Search Query Fundamentals</a></li>
</ol>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        Share
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://nightcatv.github.io/2020/09/08/Shodan%20Pentesting/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cyber-security/" rel="tag">cyber security</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/penetration-testing/" rel="tag">penetration testing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reconnaissance/" rel="tag">reconnaissance</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shodan/" rel="tag">shodan</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2021/01/23/Buffer%20Overflow%20Lab/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            Buffer Overflow Lab
          
        </div>
      </a>
    
    
      <a href="/2020/06/05/MathJax%20%E8%AA%9E%E6%B3%95%E8%A3%9C%E5%B8%96/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">MathJax 語法補帖</div>
      </a>
    
  </nav>

  
   
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2019-2021
        <i class="ri-heart-fill heart_icon"></i> NIghTcAt
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Night Vestige"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">首頁</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">文章</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分類</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">標籤</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">關於我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>請我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->

<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>